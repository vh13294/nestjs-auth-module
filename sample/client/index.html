<!DOCTYPE html>
<html>

<head>
    <title>Example</title>

    <script>
        window.fbAsyncInit = function () {
            FB.init({
                appId: '252026689618575',
                cookie: true,
                xfbml: true,
                version: 'v9.0'
            });
            FB.AppEvents.logPageView();
        };

        (function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement(s); js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
</head>

<body>
    <p>This is an example of a simple HTML page with one paragraph.</p>

    <button onclick="continueFB();">Continue With FB</button>
    <script>
        function continueFB() {
            console.log('yes')
            FB.login(callServer, { scope: 'public_profile,email' });
        }

        function callServer(fbRes) {
            console.log(fbRes)
            const url = new URL('https://localhost:3000/auth/continue-with-facebook')
            const params = {
                access_token: fbRes.authResponse.accessToken
            }
            url.search = new URLSearchParams(params).toString();
            fetch(url, { method: 'POST' })
                .then(function (res) {
                    if (!res.ok) {
                        res.json().then(obj => {
                            console.log(obj)
                            throw new Error(obj.message)
                        })
                    }
                    return res;
                }).then(function (res) {
                    console.log('ok');
                }).catch(function (error) {
                    console.log(error);
                });
        }
    </script>
</body>

</html>